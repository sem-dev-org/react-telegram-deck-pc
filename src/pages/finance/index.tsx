import { FullBleedContainer, Page, SafeContent } from '@/components/ui';
import { useState, useEffect } from 'react';

import DepositPage from './Deposit';
import SwapPage from './Swap';
import WithdrawPage from './Withdraw';
import { useSearchParams } from 'react-router-dom';
import { useTranslation } from 'react-i18next';
export default function WalletPage() {
  const [tab, setTab] = useState<'deposit' | 'withdraw' | 'swap'>('deposit');
  const [searchParams, setSearchParams] = useSearchParams();
  const { t } = useTranslation();

  // 监听URL参数变化，设置当前活动的tab
  useEffect(() => {
    const tabParam = searchParams.get('tab');
    if (tabParam && ['deposit', 'withdraw', 'swap'].includes(tabParam as any)) {
      setTab(tabParam as 'deposit' | 'withdraw' | 'swap');
    }
  }, [searchParams]);

  // 处理tab切换
  const handleTabChange = (newTab: 'deposit' | 'withdraw' | 'swap') => {
    setTab(newTab);
    // 更新URL参数
    searchParams.set('tab', newTab);
    setSearchParams(searchParams);
  };

  return (
    <FullBleedContainer>
      <SafeContent>
        <Page className="px-3 mt-3">
          <div className="tabs tabs-lift grid grid-cols-3">
            <a
              className={`tab relative flex items-center gap-2 !px-0 ${tab === 'deposit' ? 'tab-active border-base-content border-b-2' : 'border-base-content/20 border-b-2'}`}
              onClick={() => handleTabChange('deposit')}
            >
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M13.2373 11.4502H13.5186C13.8623 11.4502 14.1436 11.1689 14.1436 10.8252C14.1436 10.4814 13.8623 10.2002 13.5186 10.2002H13.2373C12.8936 10.2002 12.6123 10.4814 12.6123 10.8252C12.6123 11.1689 12.8936 11.4502 13.2373 11.4502Z"
                  fill="#A6ADBB"
                />
                <path
                  d="M8.14355 10.2002H7.8623C7.51855 10.2002 7.2373 10.4814 7.2373 10.8252C7.2373 11.1689 7.51855 11.4502 7.8623 11.4502H8.14355C8.4873 11.4502 8.76855 11.1689 8.76855 10.8252C8.76855 10.4814 8.4873 10.2002 8.14355 10.2002Z"
                  fill="#A6ADBB"
                />
                <path
                  d="M10.8311 10.2002H10.5498C10.2061 10.2002 9.9248 10.4814 9.9248 10.8252C9.9248 11.1689 10.2061 11.4502 10.5498 11.4502H10.8311C11.1748 11.4502 11.4561 11.1689 11.4561 10.8252C11.4561 10.4814 11.1748 10.2002 10.8311 10.2002Z"
                  fill="#A6ADBB"
                />
                <path
                  d="M13.5127 16.1689H13.2314C12.8877 16.1689 12.6064 16.4502 12.6064 16.7939C12.6064 17.1377 12.8877 17.4189 13.2314 17.4189H13.5127C13.8564 17.4189 14.1377 17.1377 14.1377 16.7939C14.1377 16.4502 13.8564 16.1689 13.5127 16.1689Z"
                  fill="#A6ADBB"
                />
                <path
                  d="M8.14355 16.1689H7.8623C7.51855 16.1689 7.2373 16.4502 7.2373 16.7939C7.2373 17.1377 7.51855 17.4189 7.8623 17.4189H8.14355C8.4873 17.4189 8.76855 17.1377 8.76855 16.7939C8.76855 16.4502 8.4873 16.1689 8.14355 16.1689Z"
                  fill="#A6ADBB"
                />
                <path
                  d="M10.8311 16.1689H10.5498C10.2061 16.1689 9.9248 16.4502 9.9248 16.7939C9.9248 17.1377 10.2061 17.4189 10.5498 17.4189H10.8311C11.1748 17.4189 11.4561 17.1377 11.4561 16.7939C11.4561 16.4502 11.1748 16.1689 10.8311 16.1689Z"
                  fill="#A6ADBB"
                />
                <path
                  d="M16.875 12.0191H16.3375V9.73789C16.3375 8.91289 15.6625 8.24414 14.8375 8.24414H4.19375C3.95 8.24414 3.75 8.04414 3.75 7.79414V7.43789C3.75 7.19414 3.95 6.99414 4.19375 6.99414H7.09375C7.4375 6.99414 7.71875 6.71289 7.71875 6.36914C7.71875 6.02539 7.4375 5.74414 7.09375 5.74414H4.19375C3.25625 5.74414 2.5 6.50664 2.5 7.43789V17.0066C2.5 18.3129 3.5625 19.3754 4.86875 19.3754H14.8375C15.6625 19.3754 16.3375 18.7004 16.3375 17.8754V15.6004H16.875C17.2188 15.6004 17.5 15.3191 17.5 14.9754V12.6504C17.5 12.3066 17.2188 12.0254 16.875 12.0254V12.0191ZM3.75 17.0066V9.42539C3.89375 9.46289 4.04375 9.49414 4.19375 9.49414H5.15V18.1254H4.86875C4.25 18.1254 3.75 17.6254 3.75 17.0066ZM15.0875 17.8754C15.0875 18.0191 14.9812 18.1254 14.8375 18.1254H6.4V9.49414H14.8375C14.975 9.49414 15.0875 9.60039 15.0875 9.73789V12.0191H14.7187C13.7312 12.0191 12.9313 12.8191 12.9313 13.8066C12.9313 14.7941 13.7312 15.5941 14.7187 15.5941H15.0875V17.8691V17.8754ZM16.25 14.3504H14.7187C14.425 14.3504 14.1813 14.1066 14.1813 13.8129C14.1813 13.5191 14.425 13.2754 14.7187 13.2754H16.25V14.3504Z"
                  fill="#A6ADBB"
                />
                <path
                  d="M7.31957 4.24102L10.2071 6.85352C10.4133 7.04102 10.7258 7.04102 10.9321 6.85352L13.8196 4.24102C13.9883 4.09102 14.0446 3.85352 13.9633 3.64727C13.8821 3.44102 13.6821 3.29727 13.4571 3.29727H12.2883V0.628516L8.83832 0.628516V3.29727L7.66957 3.29727C7.44457 3.29727 7.24457 3.43477 7.16332 3.64727C7.08207 3.85352 7.13832 4.09102 7.30707 4.24102H7.31957Z"
                  fill="#A6ADBB"
                />
              </svg>

              <p className='text-sm'>{t('common.deposit')}</p>
            </a>
            <a
              className={`tab relative flex items-center gap-2 !px-0 ${tab === 'withdraw' ? 'tab-active border-base-content border-b-2' : 'border-base-content/20 border-b-2'}`}
              onClick={() => handleTabChange('withdraw')}
            >
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M13.2373 11.4502H13.5186C13.8623 11.4502 14.1436 11.1689 14.1436 10.8252C14.1436 10.4814 13.8623 10.2002 13.5186 10.2002H13.2373C12.8936 10.2002 12.6123 10.4814 12.6123 10.8252C12.6123 11.1689 12.8936 11.4502 13.2373 11.4502Z"
                  fill="#A6ADBB"
                />
                <path
                  d="M8.14355 10.2002H7.8623C7.51855 10.2002 7.2373 10.4814 7.2373 10.8252C7.2373 11.1689 7.51855 11.4502 7.8623 11.4502H8.14355C8.4873 11.4502 8.76855 11.1689 8.76855 10.8252C8.76855 10.4814 8.4873 10.2002 8.14355 10.2002Z"
                  fill="#A6ADBB"
                />
                <path
                  d="M10.8311 10.2002H10.5498C10.2061 10.2002 9.9248 10.4814 9.9248 10.8252C9.9248 11.1689 10.2061 11.4502 10.5498 11.4502H10.8311C11.1748 11.4502 11.4561 11.1689 11.4561 10.8252C11.4561 10.4814 11.1748 10.2002 10.8311 10.2002Z"
                  fill="#A6ADBB"
                />
                <path
                  d="M13.5127 16.1689H13.2314C12.8877 16.1689 12.6064 16.4502 12.6064 16.7939C12.6064 17.1377 12.8877 17.4189 13.2314 17.4189H13.5127C13.8564 17.4189 14.1377 17.1377 14.1377 16.7939C14.1377 16.4502 13.8564 16.1689 13.5127 16.1689Z"
                  fill="#A6ADBB"
                />
                <path
                  d="M8.14355 16.1689H7.8623C7.51855 16.1689 7.2373 16.4502 7.2373 16.7939C7.2373 17.1377 7.51855 17.4189 7.8623 17.4189H8.14355C8.4873 17.4189 8.76855 17.1377 8.76855 16.7939C8.76855 16.4502 8.4873 16.1689 8.14355 16.1689Z"
                  fill="#A6ADBB"
                />
                <path
                  d="M10.8311 16.1689H10.5498C10.2061 16.1689 9.9248 16.4502 9.9248 16.7939C9.9248 17.1377 10.2061 17.4189 10.5498 17.4189H10.8311C11.1748 17.4189 11.4561 17.1377 11.4561 16.7939C11.4561 16.4502 11.1748 16.1689 10.8311 16.1689Z"
                  fill="#A6ADBB"
                />
                <path
                  d="M16.875 12.0191H16.3375V9.73789C16.3375 8.91289 15.6625 8.24414 14.8375 8.24414H4.19375C3.95 8.24414 3.75 8.04414 3.75 7.79414V7.43789C3.75 7.19414 3.95 6.99414 4.19375 6.99414H7.09375C7.4375 6.99414 7.71875 6.71289 7.71875 6.36914C7.71875 6.02539 7.4375 5.74414 7.09375 5.74414H4.19375C3.25625 5.74414 2.5 6.50664 2.5 7.43789V17.0066C2.5 18.3129 3.5625 19.3754 4.86875 19.3754H14.8375C15.6625 19.3754 16.3375 18.7004 16.3375 17.8754V15.6004H16.875C17.2188 15.6004 17.5 15.3191 17.5 14.9754V12.6504C17.5 12.3066 17.2188 12.0254 16.875 12.0254V12.0191ZM3.75 17.0066V9.42539C3.89375 9.46289 4.04375 9.49414 4.19375 9.49414H5.15V18.1254H4.86875C4.25 18.1254 3.75 17.6254 3.75 17.0066ZM15.0875 17.8754C15.0875 18.0191 14.9812 18.1254 14.8375 18.1254H6.4V9.49414H14.8375C14.975 9.49414 15.0875 9.60039 15.0875 9.73789V12.0191H14.7187C13.7312 12.0191 12.9313 12.8191 12.9313 13.8066C12.9313 14.7941 13.7312 15.5941 14.7187 15.5941H15.0875V17.8691V17.8754ZM16.25 14.3504H14.7187C14.425 14.3504 14.1813 14.1066 14.1813 13.8129C14.1813 13.5191 14.425 13.2754 14.7187 13.2754H16.25V14.3504Z"
                  fill="#A6ADBB"
                />
                <path
                  d="M13.8064 3.38105L10.9189 0.768555C10.7127 0.581055 10.4002 0.581055 10.1939 0.768555L7.30641 3.38105C7.13766 3.53105 7.08141 3.76855 7.16266 3.9748C7.24391 4.18105 7.44391 4.3248 7.66891 4.3248H8.83766V6.99355H12.2877V4.3248H13.4564C13.6814 4.3248 13.8814 4.1873 13.9627 3.9748C14.0439 3.76855 13.9877 3.53105 13.8189 3.38105H13.8064Z"
                  fill="#A6ADBB"
                />
              </svg>

              <p className='text-sm'>{t('common.withdraw')}</p>
            </a>
            <a
              className={`tab relative flex items-center gap-2 !px-0 ${tab === 'swap' ? 'tab-active border-base-content border-b-2' : 'border-base-content/20 border-b-2'}`}
              onClick={() => handleTabChange('swap')}
            >
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M4.6563 2.65729C4.55588 2.65886 4.45712 2.6831 4.36738 2.7282C4.27765 2.77329 4.19926 2.83807 4.13807 2.91771C4.13719 2.919 4.13633 2.92031 4.13546 2.92161L2.19536 4.86172C2.00469 5.05238 1.94749 5.33894 2.05083 5.58828C2.15416 5.83694 2.39738 5.99974 2.66671 5.99974H4.00005V13.9997C4.00005 15.8327 5.50037 17.3331 7.33338 17.3331C9.16639 17.3331 10.6667 15.8327 10.6667 13.9997V5.99974C10.6667 4.88741 11.5544 3.99974 12.6667 3.99974C13.779 3.99974 14.6667 4.88741 14.6667 5.99974V13.9997H13.3334C13.064 13.9997 12.8208 14.1625 12.7175 14.4112C12.6142 14.6605 12.6714 14.9471 12.862 15.1378L14.8034 17.0792C14.8655 17.1606 14.9454 17.2266 15.0371 17.2722C15.1288 17.3177 15.2297 17.3415 15.3321 17.3418C15.4345 17.342 15.5355 17.3187 15.6274 17.2736C15.7193 17.2285 15.7996 17.1629 15.862 17.0818C15.8629 17.0805 15.8638 17.0792 15.8646 17.0779L17.8047 15.1378C17.9954 14.9471 18.0526 14.6605 17.9493 14.4112C17.8459 14.1625 17.6027 13.9997 17.3334 13.9997H16V5.99974C16 4.16673 14.4997 2.6664 12.6667 2.6664C10.8337 2.6664 9.33338 4.16673 9.33338 5.99974V13.9997C9.33338 15.1121 8.4457 15.9997 7.33338 15.9997C6.22106 15.9997 5.33338 15.1121 5.33338 13.9997V5.99974H6.66671C6.93605 5.99974 7.17927 5.83694 7.2826 5.58828C7.38593 5.33894 7.32873 5.05238 7.13807 4.86172L5.19406 2.91771C5.13086 2.83546 5.04934 2.76909 4.95598 2.72389C4.86263 2.67868 4.76001 2.65587 4.6563 2.65729Z"
                  fill="#A6ADBB"
                />
              </svg>

              <p className='text-sm'>{t('common.swap')}</p>
            </a>
          </div>

          {tab === 'deposit' && <DepositPage isChildren />}
          {tab === 'withdraw' && <WithdrawPage isChildren />}
          {tab === 'swap' && <SwapPage isChildren />}
        </Page>
      </SafeContent>
    </FullBleedContainer>
  );
}
